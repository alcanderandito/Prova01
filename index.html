<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Team Due Mori (Mobile Only)</title>
  <style>
    /* RESET & BASE */
    *{margin:0;padding:0;box-sizing:border-box;}
    html,body{width:100%;height:100%;overflow-y:scroll;font-family:Arial,Helvetica,sans-serif;}

    /* ----------  MOBILE ONLY ---------- */
    @media (max-width:600px){
      /* BACKGROUND */
      .bg{position:fixed;top:50%;left:50%;width:120%;height:120%;object-fit:cover;transform:translate(-50%,-50%) scale(1);transform-origin:center;z-index:-2;}
      .overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:-1;pointer-events:none;}

      /* LANDING HEADER */
      header{height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;color:#fff;padding:0 20px;}
      h1{font-size:2.2rem;font-weight:700;letter-spacing:.05em;text-shadow:0 1px 4px rgba(0,0,0,.7);margin-bottom:.3em;}
      .subtitle{font-size:.95rem;text-shadow:0 1px 3px rgba(0,0,0,.7);margin-bottom:1em;}
      #scrollIndicator{font-size:2rem;animation:pulse 1.5s infinite;cursor:pointer;}
      @keyframes pulse{0%,100%{transform:scale(1);}50%{transform:scale(1.3);}}

      /* GRID CARDS */
      main{position:relative;z-index:1;min-height:200vh;padding:40px 20px 80px;}
      .nav{display:grid;gap:20px;justify-items:center;grid-template-columns:repeat(2,1fr);margin:0 auto;max-width:480px;}
      .nav a{width:100px;height:100px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.9rem;font-weight:600;color:#fff;text-decoration:none;background:rgba(255,255,255,.5);backdrop-filter:blur(4px);border:1px solid rgba(255,255,255,.3);box-shadow:0 4px 12px rgba(0,0,0,.2);opacity:0;transform:scale(0);animation:popIn .5s forwards,breath 3s ease-in-out infinite .6s;}
      @keyframes popIn{0%{opacity:0;transform:scale(0);}60%{opacity:1;transform:scale(1.2);}100%{opacity:1;transform:scale(1);}}
      @keyframes breath{0%,100%{transform:scale(1);}50%{transform:scale(1.05);}}
      .nav a:hover{transform:translateY(-4px) scale(1.05);} 
      .nav a:active{transform:translateY(0) scale(1.02);} 

      /* CHAT BUTTON */
      #chatToggle{position:fixed;top:1rem;right:1rem;width:60px;height:60px;border:none;border-radius:50%;background:#25d366 url("https://img.icons8.com/ios-filled/50/ffffff/chat--v1.png") center/60% no-repeat;cursor:pointer;z-index:1000;box-shadow:0 4px 14px rgba(0,0,0,.25);} 

      /* CHAT FULLSCREEN */
      #chatContainer{position:fixed;inset:0;display:none;flex-direction:column;width:100vw;height:100dvh;background:#ece5dd;z-index:1100;}
      .chatBar{background:#075e54;color:#fff;padding:14px 16px;font-weight:700;display:flex;align-items:center;font-size:16px;}
      .chatBody{flex:1;overflow-y:auto;padding:10px;display:flex;flex-direction:column;gap:6px;}
      .bubble{padding:8px 10px;border-radius:8px;max-width:80%;font-size:14px;line-height:1.3;box-shadow:0 1px 1px rgba(0,0,0,.1);} 
      .bot .bubble{background:#fff;color:#000;border-radius:0 8px 8px 8px;} 
      .user .bubble{background:#dcf8c6;color:#000;border-radius:8px 0 8px 8px;align-self:flex-end;}
      .chatInput{display:flex;gap:6px;background:#f0f0f0;padding:8px;align-items:center;}
      .chatInput input{flex:1;padding:10px;border:none;border-radius:20px;font-size:15px;}
      .chatInput button{width:48px;height:48px;border:none;border-radius:50%;background:#25d366;color:#fff;font-size:20px;display:flex;align-items:center;justify-content:center;}
    }

    /* DESKTOP BLOCK */
    @media (min-width:601px){header,main,#chatToggle,#chatContainer,.bg,.overlay{display:none!important;}body::before{content:"üõë Solo smartphone";white-space:pre-line;display:flex;align-items:center;justify-content:center;height:100vh;width:100%;text-align:center;font-size:2.5rem;background:#000;color:#fff;padding:0 5vw;}html,body{overflow:hidden;}}
  </style>
</head>
<body>
  <img src="home1.PNG" class="bg" id="bg" alt="sfondo" />
  <div class="overlay"></div>

  <!-- CHAT TOGGLE -->
  <button id="chatToggle" aria-label="Apri chat"></button>

  <!-- CHAT CONTAINER -->
  <div id="chatContainer">
    <div class="chatBar">Don Alfred ü§µüèª‚Äç‚ôÇÔ∏è <span id="chatClose" style="margin-left:auto;font-size:24px;cursor:pointer;">‚úï</span></div>
    <div class="chatBody" id="chatBody"></div>
    <form class="chatInput" id="chatForm" autocomplete="off">
      <input id="chatInput" placeholder="Scrivi un messaggio‚Ä¶" />
      <button type="submit">‚û§</button>
    </form>
  </div>

  <!-- LANDING CONTENT -->
  <header>
    <h1>Team Due Mori</h1>
    <div class="subtitle">Sfoglia le schede del Dream‚ÄëTeam.</div>
    <div id="scrollIndicator">‚¨áÔ∏é</div>
  </header>
  <main><nav class="nav" id="teamNav"></nav></main>

  <!-- SCRIPT -->
  <script>
    /* Background parallax */
    const bg=document.getElementById('bg'),scrollIndicator=document.getElementById('scrollIndicator'),teamNav=document.getElementById('teamNav');
    window.addEventListener('scroll',()=>{const f=Math.min(scrollY/200,1);bg.style.transform=`translate(-50%,-50%) scale(${1+f*0.5})`;});
    scrollIndicator.onclick=()=>teamNav.scrollIntoView({behavior:'smooth'});

    /* Chat logic */
    const chatToggle=document.getElementById('chatToggle'),chatContainer=document.getElementById('chatContainer'),chatClose=document.getElementById('chatClose'),chatBody=document.getElementById('chatBody'),chatForm=document.getElementById('chatForm'),chatInput=document.getElementById('chatInput'),history=[];

    chatToggle.onclick=()=>{chatContainer.style.display='flex';chatInput.focus();};
    chatClose.onclick=()=>chatContainer.style.display='none';

    function append(who,txt){const d=document.createElement('div');d.className='msg '+who;d.innerHTML=`<div class="bubble">${txt}</div>`;chatBody.appendChild(d);chatBody.scrollTop=chatBody.scrollHeight;}

    chatForm.addEventListener('submit',async e=>{
      e.preventDefault();
      const t=chatInput.value.trim();
      if(!t)return;
      append('user',t);history.push({role:'user',content:t});chatInput.value='';
      try{
        const r=await fetch('/api/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:t,history})});
        const {reply}=await r.json();
        append('bot',reply);history.push({role:'assistant',content:reply});
      }catch{append('bot','Errore di connessione üò¢');}
    });
  </script>
</body>
</html>
