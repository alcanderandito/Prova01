<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Home • Team Due Mori</title>

  <!-- Importazione Font da Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&family=Roboto:wght@300;400&display=swap" rel="stylesheet">

  <style>
    /* mini‑reset */
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{
      font-family: 'Roboto', -apple-system, Segoe UI, Arial, sans-serif;
      height: 100%;
      /* RIMOSSO: background-color: #f0f0f0; */
      overflow-x: hidden;
    }

    /* === NAVBAR FISSA === */
    .navbar {
      background-color: #383838;
      padding: 10px 20px;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 500; /* Alto, sopra tutto tranne chat */
      display: flex;
      align-items: center;
      box-shadow: 0 3px 8px rgba(0,0,0,0.25);
    }
    /* ... (stili dropdown e bottone menu invariati) ... */
     .dropdown {
      position: relative;
      display: inline-block;
    }
    .dropdown-button {
      background: linear-gradient(145deg, #6ad96a, #4caf50);
      color: white;
      padding: 12px 20px;
      font-size: 16px;
      border: none;
      cursor: pointer;
      border-radius: 8px;
      font-family: 'Roboto', sans-serif;
      font-weight: 500;
      box-shadow: 0 4px 6px rgba(0,0,0,0.15), 0 1px 3px rgba(0,0,0,0.1);
      transition: all 0.2s ease-out;
      text-shadow: 0 1px 1px rgba(0,0,0,0.2);
    }
    .dropdown-button:hover, .dropdown-button:focus {
      background: linear-gradient(145deg, #7ae07a, #5cb85c);
      transform: translateY(-2px);
      box-shadow: 0 8px 12px rgba(0,0,0,0.2), 0 3px 6px rgba(0,0,0,0.15);
    }
     .dropdown-button:active {
        transform: translateY(1px);
        box-shadow: 0 2px 3px rgba(0,0,0,0.15), 0 1px 2px rgba(0,0,0,0.1);
        background: linear-gradient(145deg, #4caf50, #6ad96a);
     }
    .dropdown-content {
      display: none;
      position: absolute;
      background-color: #ffffff;
      min-width: 230px;
      box-shadow: 0px 10px 20px 0px rgba(0,0,0,0.25);
      z-index: 999; /* Assicura sia sopra altri elementi navbar */
      border-radius: 8px;
      margin-top: 8px;
      overflow: hidden;
    }
    .dropdown-content ul { list-style-type: none; }
    .dropdown-content ul li a {
      color: #333;
      padding: 14px 18px;
      text-decoration: none;
      display: block;
      font-family: 'Roboto', sans-serif;
      transition: background-color 0.2s ease, color 0.2s ease;
    }
    .dropdown-content ul li a:hover {
        background-color: #f5f5f5;
        color: #4caf50;
    }
    .show { display: block; }
    .dropdown-content ul li.submenu-item { position: relative; }
    .dropdown-content ul li.submenu-item .submenu {
        display: none; padding-left: 0; background-color: #f8f8f8;
        border-left: 3px solid #4caf50; margin-left: 10px; margin-right: 10px; border-radius: 0 0 5px 5px;
    }
    .dropdown-content ul li.submenu-item .submenu ul li a { padding: 12px 15px 12px 25px; font-size: 0.9em; }
    .dropdown-content ul li.submenu-item .submenu ul li a:hover { background-color: #e9e9e9; color: #333;}
    .dropdown-content ul li.submenu-item .submenu.open { display: block; }
    .submenu-trigger .arrow { display: inline-block; margin-left: 8px; transition: transform 0.3s ease; font-size: 0.8em; }
    .submenu-trigger.open .arrow { transform: rotate(180deg); }


    /* === BOTTONE CHAT === */
    #goChatContainer { position: fixed; bottom: 25px; right: 25px; z-index: 1000; /* Il più alto */ }
    #goChat{
      width: 65px; height: 65px; border: none; border-radius: 50%;
      background: #25d366 url("https://img.icons8.com/ios-filled/50/ffffff/chat--v1.png") center/55% no-repeat;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.25), 0 2px 5px rgba(0,0,0,0.15);
      cursor: pointer; transition: all 0.2s ease-out;
    }
    #goChat:hover{
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 20px rgba(37, 211, 102, 0.4), 0 4px 8px rgba(0,0,0,0.2);
      background-color: #28e06e;
    }
    #goChat:active{
      transform: translateY(1px) scale(0.95);
      box-shadow: 0 2px 6px rgba(0,0,0,0.2), 0 1px 3px rgba(0,0,0,0.1);
      background-color: #22c05c;
    }

    /* === SFONDO DINAMICO (z-index modificato) === */
    #dynamic-background-container {
      position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
      z-index: 0; /* MODIFICATO: Base level */
      overflow: hidden;
      background-color: #222; /* Fallback visibile se immagini non caricano */
    }
    .background-slide {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background-size: cover; background-position: center center;
        opacity: 0;
        transition: opacity 1.8s cubic-bezier(0.4, 0, 0.2, 1);
        transform: scale(1.03); /* Base per Ken Burns */
    }
    .background-slide.active {
        opacity: 1; /* Dovrebbe renderlo visibile */
        animation: kenburns 25s infinite alternate ease-in-out;
     }
    @keyframes kenburns { 0% { transform: scale(1.03) translate(0%, 0%); } 100% { transform: scale(1.12) translate(-1.5%, 1.5%); } }
    .background-slide.active.even-slide-kenburns { animation-name: kenburns-alt; }
    @keyframes kenburns-alt { 0% { transform: scale(1.03) translate(0%, 0%); } 100% { transform: scale(1.12) translate(1.5%, -1.5%); } }

    /* === TITOLO EROE (z-index modificato) === */
    #hero-title-container {
      position: fixed; top: 48%; left: 50%; transform: translate(-50%, -50%);
      text-align: center; color: #ffffff;
      z-index: 3; /* MODIFICATO: Sopra sfondo e neve */
      padding: 20px; width: 90%; max-width: 850px;
    }
    /* ... (stili titolo h1 e p invariati) ... */
     #hero-title-container h1 {
      font-family: 'Oswald', sans-serif; font-size: 3.8rem; font-weight: 700;
      margin-bottom: 0.4em; line-height: 1.15; letter-spacing: 2px; text-transform: uppercase;
      background: linear-gradient(45deg, #ffffff, #ffeecc); -webkit-background-clip: text; background-clip: text; color: transparent;
      filter: drop-shadow(0px 3px 6px rgba(0, 0, 0, 0.8));
    }
    #hero-title-container p {
        font-family: 'Roboto', sans-serif; font-size: 1.35rem; font-weight: 300;
        line-height: 1.6; opacity: 0.95; text-shadow: 0px 2px 5px rgba(0, 0, 0, 0.8);
     }
     /* Media queries invariate */
     @media (max-width: 992px) { #hero-title-container h1 { font-size: 3.2rem; } #hero-title-container p { font-size: 1.2rem; } }
    @media (max-width: 768px) { #hero-title-container { top: 45%; } #hero-title-container h1 { font-size: 2.8rem; } #hero-title-container p { font-size: 1.05rem; } }
    @media (max-width: 480px) { #hero-title-container h1 { font-size: 2.2rem; letter-spacing: 1px; } #hero-title-container p { font-size: 0.95rem; } }


    /* === CONTENUTO PRINCIPALE (z-index verificato) === */
    .main-content {
        position: relative;
        z-index: 2; /* Sopra sfondo e neve, sotto titolo */
        padding-top: 80px; padding-left: 20px; padding-right: 20px; padding-bottom: 80px;
        min-height: calc(100vh - 80px);
        /* Aggiungi un background semi-trasparente se vuoi che il contenuto sia leggibile sopra lo sfondo */
        /* background-color: rgba(255, 255, 255, 0.8); */
        /* border-radius: 8px; */
        /* margin: 20px; */ /* Aggiungi margini se usi background */
    }

    /* === EMOJI SNOW (z-index verificato) === */
    #emoji-snow-container {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; overflow: hidden;
      z-index: 1; /* Sopra lo sfondo dinamico, sotto il resto */
    }
    .falling-emoji {
      position: absolute; top: -40px; font-size: 1.5rem; user-select: none;
      animation: fall linear infinite; color: #fff; text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    }
    @keyframes fall {
      0% { transform: translateY(0vh) rotate(0deg); opacity: 1; }
      100% { transform: translateY(105vh) rotate(720deg); opacity: 0.5; }
    }

  </style>
</head>
<body>

  <div class="navbar">
     <!-- ... (contenuto navbar invariato) ... -->
      <div class="dropdown">
          <button onclick="toggleMenu()" class="dropdown-button">
              <span style="vertical-align: middle; margin-right: 8px;">☰</span> Menu
          </button>
          <div id="menuContent" class="dropdown-content">
              <p style="padding: 15px; color: #777;">Caricamento menu...</p>
          </div>
      </div>
  </div>

  <!-- Contenitore per gli emoji che cadono -->
  <div id="emoji-snow-container"></div>

  <!-- Contenitore sfondo dinamico -->
  <div id="dynamic-background-container"></div>

  <!-- Titolo -->
  <div id="hero-title-container"><h1>Team Due Mori</h1><p>Il Dream Team (almeno la mattina, dopo il caffè).</p></div>

  <!-- Contenuto Principale -->
  <div class="main-content">
      <!-- IL TUO CONTENUTO VA QUI! -->
      <!-- Esempio:
      <div style="background: rgba(255,255,255,0.8); padding: 20px; border-radius: 8px;">
          <h2>Contenuto di prova</h2>
          <p>Testo per vedere la sovrapposizione.</p>
      </div>
       -->
   </div>

   <!-- Bottone Chat -->
  <div id="goChatContainer"><a href="chat.html" aria-label="Apri chat"><button id="goChat"></button></a></div>

  <!-- Il tuo script esistente rimane invariato -->
  <script>
    // --- SCRIPT MENU (invariato) ---
    function toggleMenu() {
      const menuContent = document.getElementById("menuContent");
      const isCurrentlyShown = menuContent.classList.contains("show");
      if (!isCurrentlyShown && (menuContent.querySelector('p') || menuContent.innerHTML.trim() === '')) {
        fetch('menu.html')
          .then(response => {
            if (!response.ok) { throw new Error('Errore nel caricamento di menu.html: ' + response.status); }
            return response.text();
          })
          .then(data => {
            menuContent.innerHTML = data.trim() === '' ? '<p style="padding: 10px; color: #888;">Menu vuoto.</p>' : data;
          })
          .catch(error => {
            menuContent.innerHTML = '<p style="padding: 10px; color: red;">Errore caricamento menu.</p>';
            console.error('Dettagli errore fetch menu.html:', error);
          });
      }
      menuContent.classList.toggle("show");
      if (!menuContent.classList.contains("show")) { closeAllSubmenus(menuContent); }
    }
    function toggleSubmenu(event, triggerElement) { /* ... (invariato) ... */ event.preventDefault(); event.stopPropagation(); const submenu = triggerElement.nextElementSibling; if (submenu && submenu.classList.contains('submenu')) { submenu.classList.toggle('open'); triggerElement.classList.toggle('open'); } }
    function closeAllSubmenus(menuContainer) { /* ... (invariato) ... */ const openSubmenus = menuContainer.querySelectorAll('.submenu.open'); openSubmenus.forEach(submenu => { submenu.classList.remove('open'); const trigger = submenu.previousElementSibling; if (trigger && trigger.classList.contains('submenu-trigger')) { trigger.classList.remove('open'); } }); }
    window.onclick = function(event) { /* ... (invariato) ... */ const menuContent = document.getElementById("menuContent"); const dropdownButton = document.querySelector('.dropdown-button'); if (menuContent && dropdownButton && !dropdownButton.contains(event.target) && !menuContent.contains(event.target)) { if (menuContent.classList.contains("show")) { menuContent.classList.remove('show'); closeAllSubmenus(menuContent); } } }

    // --- SCRIPT SFONDO DINAMICO con LOGGING AGGIUNTO ---
    document.addEventListener('DOMContentLoaded', () => {
        console.log("DOM Caricato. Avvio script sfondo dinamico."); // LOG 1
        const backgroundContainer = document.getElementById('dynamic-background-container');
        if (!backgroundContainer) {
            console.error("ERRORE: Contenitore sfondo #dynamic-background-container non trovato!"); // LOG ERRORE
            return;
        }

        const images = ['home.PNG', 'home1.PNG', 'home2.PNG', 'home3.PNG', 'home4.PNG', 'home5.PNG', 'home6.PNG', 'home7.PNG'];
        let currentImageIndex = -1;
        const slideDuration = 7500;
        const kenBurnsAnimationDuration = 25;

        console.log("Creazione slide..."); // LOG 2
        images.forEach((imageName, index) => {
            const slide = document.createElement('div');
            slide.classList.add('background-slide');
            const imageUrl = `url('${imageName}')`; 
            slide.style.backgroundImage = imageUrl;
            if (index % 2 !== 0) { slide.classList.add('even-slide-kenburns'); }
            backgroundContainer.appendChild(slide);
            console.log(` - Creata slide ${index} con immagine ${imageUrl}`); 
        });

        const slides = backgroundContainer.querySelectorAll('.background-slide');
        if (slides.length === 0) {
             console.error("ERRORE: Nessuna slide trovata/creata nel contenitore."); 
             return;
        }
        console.log(`Trovate ${slides.length} slide. Avvio slideshow.`); 

        function showNextSlide() {
            if (currentImageIndex >= 0 && slides[currentImageIndex]) {
                slides[currentImageIndex].classList.remove('active');
                slides[currentImageIndex].style.animation = 'none';
                void slides[currentImageIndex].offsetHeight; 
            }
            currentImageIndex = (currentImageIndex + 1) % slides.length;
            if (slides[currentImageIndex]) {
                console.log(`Mostrando slide ${currentImageIndex} (${images[currentImageIndex]})`); 
                slides[currentImageIndex].classList.add('active');
                const animationName = slides[currentImageIndex].classList.contains('even-slide-kenburns') ? 'kenburns-alt' : 'kenburns';
                slides[currentImageIndex].style.animation = `${animationName} ${kenBurnsAnimationDuration}s infinite alternate ease-in-out`;
            } else {
                 console.error(`ERRORE: Tentativo di accesso a slide inesistente all'indice ${currentImageIndex}`); 
            }
        }
        showNextSlide(); 
        setInterval(showNextSlide, slideDuration);

        // --- Avvio SCRIPT PER EMOJI SNOW ---
        createEmojiSnow(); 
    });

    // --- SCRIPT EMOJI SNOW (invariato) ---
    function createEmojiSnow() {
        const container = document.getElementById('emoji-snow-container');
        if (!container) return;
        const restaurantEmojis = ['🍜', '🍝', '🍷', '🍸', '🍴', '🥄', '👩‍🍳', '👨‍🍳', '🍲', '🍤', '🍙', '🍚', '🍛', '🥗', '🥐', '🥖', '🧀', '🍇', '🍈', '🍉', '🍊', '🍋', '🍍', '🍎', '🍐', '🍑', '🍒', '🍓', '🥝', '🍅', '🍆', '🥑', '🥦', '🌶️', '🥕', '🍄', '☕', '🍵'];
        const numberOfEmojis = 80;
        for (let i = 0; i < numberOfEmojis; i++) {
            const emoji = document.createElement('span');
            emoji.classList.add('falling-emoji');
            emoji.textContent = restaurantEmojis[Math.floor(Math.random() * restaurantEmojis.length)];
            emoji.style.left = `${Math.random() * 100}vw`;
            const duration = Math.random() * 8 + 7;
            emoji.style.animationDuration = `${duration}s`;
            emoji.style.animationDelay = `${Math.random() * 10}s`;
            emoji.style.fontSize = `${Math.random() * 1 + 1}rem`;
            emoji.style.opacity = `${Math.random() * 0.5 + 0.5}`;
            container.appendChild(emoji);
        }
    }
  </script>

  <!-- AGGIUNTA CODICE PER LA CANZONE (non modifica lo script sopra) -->
  <audio id="indexPageSong" src="indexsong.mp3" loop></audio>
  <script>
    // Questo script è per indexsong.mp3
    window.addEventListener('load', () => {
      const song = document.getElementById('indexPageSong');
      let hasInteracted = false; 
      let interactionListenersAdded = false;

      const tryPlayMusic = (eventSource) => {
        if (hasInteracted || !song || (song.currentTime > 0 && !song.paused && !song.ended && song.readyState >= 3) ) {
          if (interactionListenersAdded) removeInteractionListeners();
          return;
        }
        hasInteracted = true; 

        song.play().then(() => {
          console.log(`indexsong.mp3: Riproduzione avviata dopo interazione utente via ${eventSource || 'autoplay permesso'}.`);
        }).catch(e => {
          console.error(`indexsong.mp3: Errore nel tentativo di play dopo interazione via ${eventSource || 'autoplay fallito'}:`, e.name, e.message);
          hasInteracted = false; 
        }).finally(() => {
           if (interactionListenersAdded) removeInteractionListeners();
        });
      };

      const interactionEventsMap = {
        'click': { target: document.body, handler: () => tryPlayMusic('click') },
        'scroll': { target: window, handler: () => tryPlayMusic('scroll') },
        'mousemove': { target: document.body, handler: () => tryPlayMusic('mousemove') },
        'touchstart': { target: document.body, handler: () => tryPlayMusic('touchstart') },
        'keydown': { target: window, handler: () => tryPlayMusic('keydown') }
      };
      
      const addInteractionListeners = () => {
        if (interactionListenersAdded) return;
        Object.keys(interactionEventsMap).forEach(eventType => {
          const eventInfo = interactionEventsMap[eventType];
          eventInfo.target.addEventListener(eventType, eventInfo.handler, { once: true });
        });
        interactionListenersAdded = true;
        console.log("indexsong.mp3: Listener di interazione aggiunti (per click, scroll, mousemove, touchstart, keydown).");
      };

      const removeInteractionListeners = () => {
        if (!interactionListenersAdded) return;
        Object.keys(interactionEventsMap).forEach(eventType => {
          const eventInfo = interactionEventsMap[eventType];
          eventInfo.target.removeEventListener(eventType, eventInfo.handler);
        });
        interactionListenersAdded = false;
        console.log("indexsong.mp3: Listener di interazione rimossi.");
      };

      if (song) {
        song.play().then(() => {
          console.log("indexsong.mp3: Riproduzione avviata automaticamente (il browser lo ha permesso).");
          hasInteracted = true; 
        }).catch(error => {
          console.warn("indexsong.mp3: Autoplay iniziale bloccato dal browser. In attesa di interazione utente. Errore:", error.name, error.message);
          addInteractionListeners();
        });
      } else {
        console.error("Elemento audio con id 'indexPageSong' non trovato nel DOM.");
      }
    });
  </script>
  <!-- FINE AGGIUNTA CODICE PER LA CANZONE -->

</body>
</html>
